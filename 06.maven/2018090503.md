# Chap 13 프로퍼티와 자원 필터링

POM 에 프로퍼티가 참조된다는 것을 알았을 것이다

다중 프로젝트 빌드에서 연관된 디펜던시는 ${ project.groupId} 와${ project.version} 프로퍼티를 사용하여 참조될 수 있다.   
그리고 POM의 어떤 부분이라도 project 라는 접두어를 사용하여 참조할 수 있다.  
.m2/settings.xml 파일의 값 뿐만 아니라 환경 변수와 자바 시스템 프로퍼티도 참조할 수 있다.   

이장에서는 사용가능한 프로퍼티의 값의 목록과 어덯게 이식성있는 빌드를 생성하도록 도와주는지에 대한 내용을 제공한다. 

POM에서 프로퍼티 참조를 사용한다면, 메이븐이 src/main/resources 에 저장된 리소스 파일에 프로퍼티 참조를 할 수 있는 리소스 필터링 기능을 활용할 수 있다는 것을 알아야 한다.

기본적으로 이 기능은 (프로퍼티 참조가 원치 않는 값으로 변경되지 않도록) 비활성화되어있다. 

이 기능은 특정 플랫폼에 관한 빌드를 목표로 프로퍼티 파일, POM 도는 프로파일을 위한 주요 빌드 변수를 활용하는 것을 쉽게 해준다.   
이번장에서는 자원 필터링 기능을 소개하고 이식성 있는 엔터프라이즈 빌드를 생성하여 사용할 수 있는 방법에 대해 논의한다.





## 메이븐 프로퍼티들 


pom.xml 파일이나 기타 리소스에서 메이븐 프로퍼티를 적용할 때, 메이븐의 Resource 플러그인의 필터링 기능을 사용할 수 있다.

프로퍼티는 ${}로 감싸서 쓴다. 

모든 메이븐 프로젝트에서 여러 명시적인 프로퍼티를 사용할 수 있다.

*  project.*  
 메이븐 POM 내의 값을 참조 

* settings.*  
.m2/settings.xml 안에 설정한 값을 참조 

* env.*  
PATH와 M2_HOME 같은 환경 변수 참조

*  System.getProperty()  
이 메소드에서 확인할수 있는 모든 프로퍼티는 메이븐 프로퍼티와 같인 참조될 수 있다.


내부 프로퍼티 뿐만아니라 메이븐 POM, 메이븐설정, 또는 메이븐 프로파일에 사용자 정의 프로퍼티를 이의로 정읳라 수 있다. 다음 절은 메이븐 프로젝트에서 쓰일 수 있는 다양한 프로퍼티에 관한 자세한 정보다.


**메이븐 프로젝트 프로퍼티**

메이븐 프로젝트 프로퍼티가 참조될 때 프로퍼티 명은 메이븐의 POM 프로퍼티를 참조하게 된다.

모델 객체의 빈 프로퍼티를 참조하기 위해서 간단히 점표기법을 사용한다... (${project.version} 은 .getVersion() 메소드를 실제로 호출한다 )


* project.groupId 와 project.version  
 대규모 프로젝트의 다중 모듈 빌드는 종종 동일 그룹아이디와 버전을 공유 한다. 이럴때는 POM에서 ${project.groupId}와 ${project.version}를 이용한다.

*project.artifactId  
프로젝트의 아티팩트 아이디는 종종 배포명으로 사용된다. war를 패키징할때 <finalName>의 값을 아티팩트 아이디의 참조값으로 주면 된다 

* project.name 과 project.description  
name과 프로젝트 description은 문서에서 참조할 때 유익한 프로퍼티가 되곤한다. 사이트의 문서를 이 프로퍼티들을 참조해서 사용할 수 있다고?


* project.build  
 메이븐에서 아웃풋 디렉토리를 참조할 때 쓴다 (target/classes같은 디렉토리를 참조하는게 아니다..!)
	- project.build.sourceDirectory
	- project.build.scriptSourceDirectory
	- project.build.testSourceDirectory

	~ 프로젝트의 소스 디렉토리에 접근할 수 있도록 지원 

	- project.build.outputDirectory
	- project.build.testOutputDirectory

		~ 메이븐이 바이트코드를 삽입하거나 빌드 아웃풋을 하려는 곳 디렉토리에 접근 지원

	- project.build.directory

		~ 모든 아웃풋 디렉토리를 포함한 디렉토리

**메이븐 설정 프로퍼티**  
.m2/settings.xml에 저장되어있는 메이븐 로컬 설정 파일 내의 프로퍼티를 참조할 수 있다. 


**환경 변수 프로퍼티**  
환경 변수는 env.* 접두사로 참조할 수 있다.

- env.PATH
		메이븐이 동작하는 현재 경로 

- env.HOME
		*nix 시스템 상에서 이 변수는 사용자의 홈 디렉토리를 나타낸다. ${user.home} 프로퍼티 사용 권장 

- env.JAVA_HOME
		자바 설치 디렉토리. 이 프로퍼티대신 ${java.home} 프로퍼티를 참조하는 것을 권장		

- env.M2_HOME
		메이븐 2 설치 디렉토리

**Java 시스템 프로퍼티**

메이븐은 java.lang.System 의 모든 프로퍼티를 사용할 수 있도록 지원한다. 
사용가능한 프로퍼티의 목록은 368 페이지 참고

**사용자 정의 프로퍼티**

사용자 정의 프로퍼티는 POM이나 프로파일에서 정의될 수 있다. POm 이나 프로파일 프로퍼티 집합은 마치 메이븐의 어디서든 사용할 수 있는 다른 어떤 프로퍼티처럼 참조될 수 있다. 
POM에서 참조될 수 있으며, 또는 메이븐 리소스 플러그인을 매개로 필터 리소스에 사용될 수 있다. 

POM에서의 사용자 정의 프로퍼티의 정의 예시는 369~370 페이지 참고


## 리소스 필터링 

메이븐은프로젝트 리소스를 바탕으로 변수 교체를 할 수 있다. 리소스 필터링이 활성화될때 메이븐은 ${}로 메이븐 프로퍼티 변수를 참조할 수 있게 리소스를 검색한다.   
이런 레퍼런스들을 찾으면, POM을 참조하는 프로퍼티들과 같은 방법으로 적합한 값을로 교체된다.

이 기능은 근복적으로 다른 타깃 플랫폼에 따라 다른 설정을 가진 빌드를 구성할 수 있도록 도와준다.  
예를 들어 개발하다가 제품화하면서 서버를 바꾼다면, 애플리케이션의 설정을 구체화할 수 있는 JNDI를 사용할 수 있고,또는 목표 플랫폼에 의존하는 다른 값을 가진 변수를 어떻게 대체할지에 대해 알고있는 빌드를 생성할 수 있다.
